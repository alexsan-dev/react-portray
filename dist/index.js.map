{"version":3,"file":"index.js","sources":["../src/index.tsx"],"sourcesContent":["// REACT\nimport * as React from 'react'\n\n// MAIN HOC\ninterface PortrayContextProps {\n  mainLang?: string\n  langs?: string[]\n}\n\n// CONTEXTO\ninterface PortrayContext {\n  setLang: (langCode: string) => void\n  strings: PortrayDict\n  langCode: string\n  mainLang: string\n  langs: string[]\n}\nconst defContext: PortrayContext = {\n  langs: ['en', 'es'],\n  setLang: () => {},\n  mainLang: 'en',\n  langCode: 'en',\n  strings: {}\n}\nconst portrayContext: React.Context<PortrayContext> =\n  React.createContext(defContext)\n\nexport function withPortray<T>(\n  Component: React.FC<T>,\n  strings: PortrayDict,\n  settings?: PortrayContextProps\n) {\n  // COMPONENTE\n  const PortrayWrappedComponent: React.FC<T> = (props: T) => {\n    // ESTADO\n    const mainLang: string = settings?.mainLang || 'en'\n    const [langCode, setLang] = React.useState<string>(mainLang)\n\n    // RENDER\n    return (\n      <portrayContext.Provider\n        value={{\n          langCode,\n          setLang,\n          mainLang,\n          strings,\n          langs: settings?.langs || ['en', 'es']\n        }}\n      >\n        <Component {...props} />\n      </portrayContext.Provider>\n    )\n  }\n\n  // RENDER\n  return PortrayWrappedComponent\n}\n\n// OBTENER TEXTO\nfunction getTextFromDict(key: TemplateStringsArray, ctx: PortrayContext) {\n  // FORMATO DE KEY\n  const trimmedKey: string = key[0].trim()\n\n  // VERIFICAR SI EXISTE\n  if (trimmedKey in ctx.strings) {\n    const text: string = ctx.strings[trimmedKey][ctx.langCode]\n    return text === '$' ? trimmedKey : text\n  } else {\n    // CREAR\n    const tmpStrings: PortrayDict = { ...ctx.strings }\n    tmpStrings[trimmedKey] = Object.fromEntries(\n      ctx.langs.map((langCode: string) => [\n        langCode,\n        langCode === ctx.mainLang ? '$' : ''\n      ])\n    )\n\n    // RETORNAR\n    return trimmedKey\n  }\n}\n\n// HOC\nexport function withStrings<T>(Component: Portray.FC<T>) {\n  // COMPONENTE\n  const WithStringsComponent: React.FC<T> = (props: T) => {\n    // CONTEXTO\n    const ctx = React.useContext(portrayContext)\n    function $(key: TemplateStringsArray) {\n      return getTextFromDict(key, ctx)\n    }\n\n    // RENDER\n    return <Component {...props} {...ctx} $={$} />\n  }\n\n  // RENDER\n  return WithStringsComponent\n}\n\nexport namespace Portray {\n  type Props<P> = P &\n    PortrayContext & {\n      $: (key: TemplateStringsArray) => string\n    }\n\n  export type FC<P = {}> = FunctionComponent<P>\n\n  interface FunctionComponent<P = {}> {\n    (\n      props: React.PropsWithChildren<Props<P>>,\n      context?: any\n    ): React.ReactElement<any, any> | null\n    propTypes?: React.WeakValidationMap<P>\n    contextTypes?: React.ValidationMap<any>\n    defaultProps?: Partial<P>\n    displayName?: string\n  }\n}\n\n// EXPORTAR\nexport default Portray\n"],"names":["defContext","langs","setLang","mainLang","langCode","strings","portrayContext","React","withPortray","Component","settings","PortrayWrappedComponent","props","Provider","value","getTextFromDict","key","ctx","trimmedKey","trim","text","tmpStrings","Object","fromEntries","map","withStrings","WithStringsComponent","$"],"mappings":";;;;;;;;;;;;;;;;;;;;AAiBA,IAAMA,UAAU,GAAmB;AACjCC,EAAAA,KAAK,EAAE,CAAC,IAAD,EAAO,IAAP,CAD0B;AAEjCC,EAAAA,OAAO,EAAE,qBAFwB;AAGjCC,EAAAA,QAAQ,EAAE,IAHuB;AAIjCC,EAAAA,QAAQ,EAAE,IAJuB;AAKjCC,EAAAA,OAAO,EAAE;AALwB,CAAnC;AAOA,IAAMC,cAAc,GAClBC,mBAAA,CAAoBP,UAApB,CADF;SAGgBQ,YACdC,WACAJ,SACAK;AAGA,MAAMC,uBAAuB,GAAgB,SAAvCA,uBAAuC,CAACC,KAAD;AAE3C,QAAMT,QAAQ,GAAW,CAAAO,QAAQ,SAAR,IAAAA,QAAQ,WAAR,YAAAA,QAAQ,CAAEP,QAAV,KAAsB,IAA/C;;AACA,0BAA4BI,cAAA,CAAuBJ,QAAvB,CAA5B;AAAA,QAAOC,QAAP;AAAA,QAAiBF,OAAjB;;AAGA,WACEK,mBAAA,CAACD,cAAc,CAACO,QAAhB;AACEC,MAAAA,KAAK,EAAE;AACLV,QAAAA,QAAQ,EAARA,QADK;AAELF,QAAAA,OAAO,EAAPA,OAFK;AAGLC,QAAAA,QAAQ,EAARA,QAHK;AAILE,QAAAA,OAAO,EAAPA,OAJK;AAKLJ,QAAAA,KAAK,EAAE,CAAAS,QAAQ,SAAR,IAAAA,QAAQ,WAAR,YAAAA,QAAQ,CAAET,KAAV,KAAmB,CAAC,IAAD,EAAO,IAAP;AALrB;KADT,EASEM,mBAAA,CAACE,SAAD,oBAAeG,MAAf,CATF,CADF;AAaD,GAnBD;;AAsBA,SAAOD,uBAAP;AACD;;AAGD,SAASI,eAAT,CAAyBC,GAAzB,EAAoDC,GAApD;AAEE,MAAMC,UAAU,GAAWF,GAAG,CAAC,CAAD,CAAH,CAAOG,IAAP,EAA3B;;AAGA,MAAID,UAAU,IAAID,GAAG,CAACZ,OAAtB,EAA+B;AAC7B,QAAMe,IAAI,GAAWH,GAAG,CAACZ,OAAJ,CAAYa,UAAZ,EAAwBD,GAAG,CAACb,QAA5B,CAArB;AACA,WAAOgB,IAAI,KAAK,GAAT,GAAeF,UAAf,GAA4BE,IAAnC;AACD,GAHD,MAGO;AAEL,QAAMC,UAAU,gBAAqBJ,GAAG,CAACZ,OAAzB,CAAhB;;AACAgB,IAAAA,UAAU,CAACH,UAAD,CAAV,GAAyBI,MAAM,CAACC,WAAP,CACvBN,GAAG,CAAChB,KAAJ,CAAUuB,GAAV,CAAc,UAACpB,QAAD;AAAA,aAAsB,CAClCA,QADkC,EAElCA,QAAQ,KAAKa,GAAG,CAACd,QAAjB,GAA4B,GAA5B,GAAkC,EAFA,CAAtB;AAAA,KAAd,CADuB,CAAzB;AAQA,WAAOe,UAAP;AACD;AACF;;SAGeO,YAAehB;AAE7B,MAAMiB,oBAAoB,GAAgB,SAApCA,oBAAoC,CAACd,KAAD;AAExC,QAAMK,GAAG,GAAGV,gBAAA,CAAiBD,cAAjB,CAAZ;;AACA,aAASqB,CAAT,CAAWX,GAAX;AACE,aAAOD,eAAe,CAACC,GAAD,EAAMC,GAAN,CAAtB;AACD;;AAGD,WAAOV,mBAAA,CAACE,SAAD,oBAAeG,OAAWK;WAAQU;MAAlC,CAAP;AACD,GATD;;AAYA,SAAOD,oBAAP;AACD;;;;;"}